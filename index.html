<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDSNCC | Global Intelligence AI</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --neon: #00ffcc; --neon-pink: #ff0055; --bg: #05070a; --glass: rgba(255, 255, 255, 0.05); }
        body { background: var(--bg); color: white; font-family: 'Orbitron', sans-serif; margin: 0; }
        
        .grid-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-image: linear-gradient(var(--glass) 1px, transparent 1px), linear-gradient(90deg, var(--glass) 1px, transparent 1px);
            background-size: 40px 40px; transform: perspective(500px) rotateX(60deg); transform-origin: top;
            animation: move 3s linear infinite; z-index: -1; opacity: 0.2; }
        @keyframes move { from { background-position: 0 0; } to { background-position: 0 40px; } }

        .app { max-width: 600px; margin: 20px auto; padding: 20px; }
        
        /* å›½æ——ä»˜ãè¨€èªã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ */
        .lang-control { display: flex; justify-content: flex-end; align-items: center; gap: 10px; margin-bottom: 20px; }
        .lang-label { font-size: 0.7rem; color: var(--neon); letter-spacing: 1px; }
        select { background: rgba(0,0,0,0.8); color: white; border: 1px solid var(--neon); padding: 10px; border-radius: 8px; cursor: pointer; font-family: sans-serif; }

        .glass-card { background: rgba(13, 17, 23, 0.9); backdrop-filter: blur(20px); border: 1px solid var(--neon); border-radius: 30px; padding: 30px; box-shadow: 0 0 40px rgba(0, 255, 204, 0.1); text-align: center; border-top: 5px solid var(--neon); }
        .speed-val { font-size: 5.5rem; font-weight: 900; color: var(--neon); text-shadow: 0 0 25px var(--neon); margin: 5px 0; }
        
        .metrics { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 25px 0; }
        .m-box { background: var(--glass); padding: 15px; border-radius: 15px; border-top: 1px solid rgba(0,255,204,0.3); }
        .m-label { font-size: 0.7rem; color: #888; margin-bottom: 5px; text-transform: uppercase; }
        
        button { background: transparent; border: 2px solid var(--neon); color: var(--neon); padding: 20px; width: 100%; border-radius: 50px; font-weight: 900; cursor: pointer; letter-spacing: 3px; transition: 0.4s; overflow: hidden; position: relative; }
        button:hover { background: var(--neon); color: #000; box-shadow: 0 0 50px var(--neon); transform: scale(1.02); }
        
        #ai-box { margin-top: 30px; text-align: left; padding: 20px; background: rgba(0, 255, 204, 0.05); border-left: 4px solid var(--neon-pink); border-radius: 0 15px 15px 0; display: none; }
        canvas { margin-top: 30px; background: rgba(0,0,0,0.4); border-radius: 25px; padding: 15px; border: 1px solid #1f2937; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap" rel="stylesheet">
</head>
<body>
    <div class="grid-bg"></div>
    <div class="app">
        <div class="lang-control">
            <span class="lang-label">AUTO-DETECTED LANGUAGE</span>
            <select id="lang-menu">
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­å›½èª</option>
                <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
            </select>
        </div>

        <div class="glass-card">
            <div id="ui-status" style="font-size: 0.7rem; color: var(--neon-pink); font-weight: bold;"></div>
            <div id="speed-display" class="speed-val">0.0</div>
            <div style="color: var(--neon); font-size: 1.2rem; letter-spacing: 5px; margin-bottom: 20px;">MBPS</div>

            <div class="metrics">
                <div class="m-box"><div id="ui-ping" class="m-label"></div><div id="res-ping" style="color:var(--neon); font-weight: bold;">--</div></div>
                <div class="m-box"><div id="ui-jitter" class="m-label"></div><div id="res-jitter" style="color:var(--neon); font-weight: bold;">--</div></div>
                <div class="m-box"><div id="ui-grade" class="m-label"></div><div id="res-grade" style="color:var(--neon-pink); font-weight: bold;">--</div></div>
            </div>

            <button id="run-btn"></button>
            <div id="ai-box">
                <b id="ui-ai-head" style="color:var(--neon)"></b><br>
                <span id="ai-text" style="font-size: 0.85rem; line-height: 1.6;"></span>
            </div>
        </div>
        <canvas id="chart"></canvas>
    </div>

<script>
    const i18n = {
        ja: { status: "ã‚·ã‚¹ãƒ†ãƒ : ã‚ªãƒ³ãƒ©ã‚¤ãƒ³", run: "åˆ†æã‚¨ãƒ³ã‚¸ãƒ³èµ·å‹•", ping: "å¿œç­”é€Ÿåº¦", jitter: "ãƒ–ãƒ¬", grade: "è©•ä¾¡", ai: "ğŸ¤– AIè¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆ:", s_msg: "é©šç•°çš„ãªå¸¯åŸŸã§ã™ã€‚AIã®å¤§è¦æ¨¡å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®åŒæœŸã«å®Œå…¨å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚", a_msg: "è‰¯å¥½ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰AIã¨ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã«ååˆ†ãªå“è³ªã§ã™ã€‚" },
        en: { status: "SYSTEM: ONLINE", run: "BOOT ANALYZER", ping: "Latency", jitter: "Jitter", grade: "Grade", ai: "ğŸ¤– AI DIAGNOSIS:", s_msg: "Incredible bandwidth. Fully compatible with large-scale AI training sync.", a_msg: "Good quality. Sufficient for real-time cloud AI communication." },
        zh: { status: "ç³»ç»Ÿ: åœ¨çº¿", run: "å¯åŠ¨åˆ†æå¼•æ“", ping: "å»¶è¿Ÿ", jitter: "æŠ–åŠ¨", grade: "ç­‰çº§", ai: "ğŸ¤– AI è¯Šæ–­æŠ¥å‘Š:", s_msg: "å¸¦å®½æƒŠäººã€‚å®Œå…¨æ”¯æŒå¤§è§„æ¨¡ AI å­¦ä¹ æ•°æ®çš„åŒæ­¥ã€‚", a_msg: "è‰¯å¥½ã€‚è¶³ä»¥æ»¡è¶³äº‘ç«¯ AI çš„å®æ—¶é€šä¿¡éœ€æ±‚ã€‚" },
        hi: { status: "à¤¸à¤¿à¤¸à¥à¤Ÿà¤®: à¤‘à¤¨à¤²à¤¾à¤‡à¤¨", run: "à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤• à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚", ping: "à¤ªà¤¿à¤‚à¤—", jitter: "à¤œà¤¿à¤Ÿà¤°", grade: "à¤—à¥à¤°à¥‡à¤¡", ai: "ğŸ¤– AI à¤¨à¤¿à¤¦à¤¾à¤¨ à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ:", s_msg: "à¤…à¤µà¤¿à¤¶à¥à¤µà¤¸à¤¨à¥€à¤¯ à¤¬à¥ˆà¤‚à¤¡à¤µà¤¿à¤¡à¥à¤¥à¥¤ AI à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£ à¤¸à¤¿à¤‚à¤• à¤•à¥‡ à¤²à¤¿à¤ à¤ªà¥‚à¤°à¥€ à¤¤à¤°à¤¹ à¤¸à¥‡ à¤…à¤¨à¥à¤•à¥‚à¤²à¥¤", a_msg: "à¤…à¤šà¥à¤›à¥€ à¤—à¥à¤£à¤µà¤¤à¥à¤¤à¤¾à¥¤ à¤•à¥à¤²à¤¾à¤‰à¤¡ AI à¤¸à¤‚à¤šà¤¾à¤° à¤•à¥‡ à¤²à¤¿à¤ à¤ªà¤°à¥à¤¯à¤¾à¤ªà¥à¤¤à¥¤" },
        es: { status: "SISTEMA: EN LÃNEA", run: "INICIAR ANALIZADOR", ping: "Latencia", jitter: "Jitter", grade: "Grado", ai: "ğŸ¤– INFORME DE IA:", s_msg: "Ancho de banda increÃ­ble. Totalmente compatible con el entrenamiento de IA.", a_msg: "Buena calidad. Suficiente para comunicaciÃ³n de IA en la nube." },
        ar: { status: "Ø§Ù„Ù†Ø¸Ø§Ù…: Ù…ØªØµÙ„", run: "Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„", ping: "Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©", jitter: "Ø§Ù„ØªÙ‚Ø·Ø¹", grade: "Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", ai: "ğŸ¤– ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ:", s_msg: "Ù†Ø·Ø§Ù‚ ØªØ±Ø¯Ø¯ÙŠ Ù…Ø°Ù‡Ù„. Ù…ØªÙˆØ§ÙÙ‚ ØªÙ…Ø§Ù…Ù‹Ø§ Ù…Ø¹ Ù…Ø²Ø§Ù…Ù†Ø© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.", a_msg: "Ø¬ÙˆØ¯Ø© Ø¬ÙŠØ¯Ø©. ÙƒØ§ÙÙŠØ© Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©." },
        fr: { status: "SYSTÃˆME: EN LIGNE", run: "LANCER L'ANALYSE", ping: "Latence", jitter: "Gigue", grade: "Grade", ai: "ğŸ¤– RAPPORT D'IA:", s_msg: "Bande passante incroyable. IdÃ©al pour l'apprentissage profond de l'IA.", a_msg: "Bonne qualitÃ©. Suffisant pour l'IA en temps rÃ©el." }
    };

    const firebaseConfig = {
        apiKey: "AIzaSyAkYJBtlTBsW5vFw_yPmyzJdir1FJ9anx8",
        databaseURL: "https://network-597fd-default-rtdb.firebaseio.com/",
        projectId: "network-597fd"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentLang = 'ja';
    
    // --- è¨€èªè‡ªå‹•åˆ¤åˆ¥ãƒ­ã‚¸ãƒƒã‚¯ ---
    function detectLanguage() {
        const browserLang = navigator.language.split('-')[0]; // "en-US" -> "en"
        if (i18n[browserLang]) {
            currentLang = browserLang;
            document.getElementById('lang-menu').value = browserLang;
        }
    }

    function updateUI() {
        const t = i18n[currentLang];
        document.getElementById('ui-status').textContent = t.status;
        document.getElementById('run-btn').textContent = t.run;
        document.getElementById('ui-ping').textContent = t.ping;
        document.getElementById('ui-jitter').textContent = t.jitter;
        document.getElementById('ui-grade').textContent = t.grade;
        document.getElementById('ui-ai-head').textContent = t.ai;
    }

    document.getElementById('lang-menu').onchange = (e) => {
        currentLang = e.target.value;
        updateUI();
    };

    const chart = new Chart(document.getElementById('chart'), {
        type: 'line',
        data: { labels: [], datasets: [{ label: 'Mbps', borderColor: '#00ffcc', data: [], tension: 0.4, fill: true, backgroundColor: 'rgba(0, 255, 204, 0.05)' }] },
        options: { plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#1f2937' } }, x: { grid: { display: false } } } }
    });

    db.ref("scores").limitToLast(12).on("value", snap => {
        const labels = [], data = [];
        snap.forEach(c => {
            labels.push(new Date(c.val().timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}));
            data.push(c.val().speed);
        });
        chart.data.labels = labels;
        chart.data.datasets[0].data = data;
        chart.update();
    });

    document.getElementById('run-btn').onclick = async () => {
        const btn = document.getElementById('run-btn');
        btn.disabled = true;
        const startP = performance.now();
        await fetch("https://speed.cloudflare.com/cdn-cgi/trace", {mode:'no-cors'});
        const ping = performance.now() - startP;
        document.getElementById('res-ping').textContent = ping.toFixed(0) + "ms";

        const startS = performance.now();
        const res = await fetch("https://speed.cloudflare.com/__down?bytes=10000000&t="+Date.now());
        const reader = res.body.getReader();
        let loaded = 0;
        while(true) {
            const {done, value} = await reader.read();
            if (done) break;
            loaded += value.length;
            const m = (loaded * 8) / ((performance.now() - startS) / 1000 * 1000000);
            document.getElementById('speed-display').textContent = m.toFixed(1);
        }
        const final = parseFloat(document.getElementById('speed-display').textContent);
        
        const g = final > 300 ? "S" : "A";
        document.getElementById('res-grade').textContent = g;
        document.getElementById('ai-box').style.display = "block";
        document.getElementById('ai-text').textContent = g === "S" ? i18n[currentLang].s_msg : i18n[currentLang].a_msg;

        await db.ref("scores").push({ speed: final, timestamp: Date.now() });
        btn.disabled = false;
    };

    // åˆæœŸåŒ–å®Ÿè¡Œ
    detectLanguage();
    updateUI();
</script>
</body>
</html>
